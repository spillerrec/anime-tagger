<!DOCTYPE html>
<html>
	<head>
		<style>
			html {
				background-color: black;
				color:white;
			}
			#image {
				position:relative;
				cursor: crosshair;
				max-width: 100%;
				max-height: 1000px;
				object-fit: scale-down;
			}
			#container{
				position: relative;
			}
			.rectangle {
				position: absolute;
				border: 1px solid black;
				pointer-events: none;
			}
			p {
			   color:white;
			}
		</style>
	</head>
	<body>
		<h1>Show all images with the following tags:</h1>
		<input type="text" id="searchbox" oninput="update()">
		<div id="results">
		
		</div>
		<script>
		
var getJSON = function(url, callback) {
    var xhr = new XMLHttpRequest();
    xhr.open('GET', url, true);
    xhr.responseType = 'json';
    xhr.onload = function() {
      var status = xhr.status;
      if (status === 200) {
        callback(null, xhr.response);
      } else {
        callback(status, xhr.response);
      }
    };
    xhr.send();
};

			ids = [];
			
			var updatePage = function(){
			var resultsDiv = document.getElementById("results");
			while (resultsDiv.firstChild) {
				resultsDiv.removeChild(resultsDiv.firstChild);
			}
				ids.forEach(function(id){
					var img = document.createElement("img");
					img.src = '/thumbnail/256/' + id['id'];
					img.title = id['prompt'];
					resultsDiv.appendChild(img);
				});
			};
			
			function update() {
				var inputValue = document.getElementById("searchbox").value;
				getJSON('/ids/' + inputValue,
				function(err, data) {
				  if (err !== null) {
					 alert('Something went wrong: ' + err);
				  } else {
					 ids = data;
					 updatePage();
				  }
				});
			}
		</script>
	</body>
</html>